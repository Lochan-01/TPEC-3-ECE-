#include <reg52.h>
#define DEGREES 180

void delay(unsigned int value);

void main()
{
    unsigned int i;
    unsigned int steps;
    unsigned char clockwise[]  = {0x01, 0x02, 0x04, 0x08};
    unsigned char anticlock[] = {0x08, 0x04, 0x02, 0x01};
    
    P2 = 0x00;
    steps = DEGREES / 1.8;  // Each step = 1.8 degrees ? 200 steps per revolution

    // Rotate 180° Clockwise
    for(i = 0; i < steps; i++)
    {
        P2 = clockwise[i % 4];
        delay(10);
    }

    delay(100); // Pause before changing direction

    // Rotate 180° Anticlockwise
    for(i = 0; i < steps; i++)
    {
        P2 = anticlock[i % 4];
        delay(10);
    }

    while(1);  // Stop program
}

void delay(unsigned int ms)
{
    unsigned int i, j;
    for(i = 0; i < ms; i++)
        for(j = 0; j < 1275; j++);
}
